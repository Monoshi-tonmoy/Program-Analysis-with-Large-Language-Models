[{"role": "system", "content": "You are a program analyst specializing in security vulnerabilities related to memory, buffer, and pointer misuse."}, {"role": "user", "content": "The following C / C++ code may or may not contain misuses such as memory, buffer or pointer issues, and is enclosed in triple backticks. Analyze the following code\n'''\n#define SUCCESS (1)\n#define FAILURE (0)\n\nint contains_char(char c){\n    char *str;\n    str = (char*)malloc(20*sizeof(char));\n    strcpy(str, \"Search Me!\");\n    while( *str != NULL){\n        if( *str == c ){\n            /* matched char, free string and return success */\n            free(str);\n            return SUCCESS;\n        }\n        /* didn't match yet, increment pointer and try next char */\n        str = str + 1;\n    }\n    /* we did not match the char in the string, free mem and return failure */\n\n    free(str);\n    return FAILURE;\n}\n'''"}]